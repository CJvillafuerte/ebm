<!DOCTYPE html>
<html>
<head>
    <title><%= title %></title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/0.3.2/leaflet.draw.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/0.3.2/leaflet.draw.css" />
    <link rel="stylesheet" href="https://cdn.rawgit.com/wyuenho/backgrid/master/lib/backgrid.css" />
    <link rel="stylesheet" href="https://cdn.rawgit.com/wyuenho/backgrid-select-all/master/backgrid-select-all.css" />
    <!-- select -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.11.2/css/bootstrap-select.min.css" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/css/bootstrap-datepicker.css" />


    <link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.css' />
    <!-- Latest compiled and minified CSS -->
     <link rel='stylesheet' href='/stylesheets/eb.css' /> 

    <style>
        /*
  * Additional Style tweaks
  * --------------------------------------------------
  */
        body {
            padding-top: 12px;
            background-color: #f5f5f5;
        }
        footer {
            padding-left: 15px;
            padding-right: 15px;
            background-color: #fff;
        }


        .card-box {
            padding: 20px;
            border: 1px solid rgba(54, 64, 74, 0.08);
            -webkit-border-radius: 5px;
            border-radius: 5px;
            -moz-border-radius: 5px;
            background-clip: padding-box;
            margin-bottom: 20px;
            background-color: #fff;
        }

        .form-inline > * {
            margin:15px 0px !important;
        }
        .card-box {
            padding: 20px;
            border: 1px solid rgba(54, 64, 74, 0.08);
            -webkit-border-radius: 5px;
            border-radius: 5px;
            -moz-border-radius: 5px;
            background-clip: padding-box;
            margin-bottom: 20px;
            background-color: #fff;
        }

        #loading-img {
            background: url(images/3.gif) center center no-repeat;
            height: 100%;
            z-index: 20;
        }

        .overlay {
            background: #e9e9e9;
            display: none;
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            opacity: 0.5;
        }

    </style>
    <!-- Bootstrap core JavaScript================================================== -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script src="javascripts/eb.js"></script>


    <script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.11.2/js/bootstrap-select.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/js/bootstrap-datepicker.js"></script>


</head>
<body>


<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">Energy Balance Modeling (beta)</a>
        </div>
        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
                <li><a href="#">Dashboard</a></li>
                <li><a href="#">APIs</a></li>
                <li><a href="#">Profile</a></li>
                <li><a href="#">Help</a></li>
            </ul>
            <form class="navbar-form navbar-right">
                <input type="text" class="form-control" placeholder="Search...">
            </form>
        </div>
    </div>
</nav>

<div class="container-fluid">

    <div class="row ">

        <div class="col-sm-9 col-md-10 main">

            <div class="page-header"></div>

            <div class="row">
                <div class="col-lg-6 col-md-6">
                    <div id="map" style="width: 500px; height: 650px"></div>

                    <!--<span class="text-muted">Something else</span> -->
                </div>

                <div id="main" class="col-lg-6 col-md-6">

                    <div class="card-box">

                        <!--<span class="text-muted">Something else</span> -->
                        <form id="extractform" method="post"  class="form-inline">

                            <div class="form-group">

                                <label class="control-label">Variable</label>

                                <select class="selectpicker" id="variable" name="variable" data-header="Select a variable">

                                    <optgroup label="WRF">
                                        <option disabled>Albedo</option>
                                        <option disabled>BGAP</option>
                                        <option disabled>FVEG</option>
                                        <option disabled>GLW</option>
                                        <option disabled>ISNOW</option>
                                        <option disabled>SWDOWN</option>
                                        <option disabled>TAH</option>
                                        <option disabled>TV</option>
                                        <option disabled>WGAP</option>
                                        <option disabled>TG</option>
                                        <option disabled>T2</option>
                                        <option disabled>QAIR</option>
                                        <optiondisabled>SMOIS</optiondisabled>
                                    </optgroup>
                                    <optgroup label="Microclimate">
                                        <option disabled>Tair</option>
                                        <option>Tsurface</option>
                                        <option disabled>Tsoil</option>
                                        <option disabled>UV</option>
                                    </optgroup>

                                </select>

                            </div>


                            <div class="form-group">
                                <label class="control-label input-group">Locations</label>
                                <span class="text-muted">select the geographic bounding box</span>
                                <div class="input-group">
                                    <input type="number" class="form-control" id="lat" name="lat" placeholder="Lat">
                                    <label for="lat" class="control-label">degrees N Lat</label>
                                    <span class="input-group-addon"></span>
                                    <input type="number" class="form-control" id="lng" name="lng" placeholder="Lon">
                                    <label for="lng" class="control-label">degrees E Lon</label>
                                </div>
                            </div>


                            <div class="form-group ">
                                <label class="control-label input-group">Time periods</label>
                                <div class="input-group">
                                    <input type="text" class="form-control datepicker"  id="stdate" name="stdate" placeholder="Start Date" required>
                                    <label for="stdate" class="control-label">Start Date</label>
                                    <span class="input-group-addon">-</span>

                                    <input type="text" class="form-control datepicker" data-date-end-date="1y" id="eddate" name="eddate" placeholder="End Date" required>
                                    <label for="eddate" class="control-label">End Date</label>
                                </div>
                            </div>


                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="interval" class="control-label input-group">Interval</label>
                                    <select id="interval" class="selectpicker" disabled>
                                        <option>Hourly</option>
                                        <option>6 Hourly</option>
                                        <option>12 Hourly</option>
                                        <option>Daily</option>
                                        <option>Monthly</option>
                                        <option>Annual</option>
                                    </select>
                                    <label for="aggregation" class="control-label input-group">Aggregation Metric</label>
                                    <select id="aggregation" class="selectpicker" disabled>
                                        <option>Instantaneous</option>
                                        <option>Max</option>
                                        <option>Min</option>
                                        <option>Mean</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="file" class="control-label input-group">Output file format</label>
                                <div class="btn-group" data-toggle="buttons">
                                    <label class="btn btn-default active">
                                        <input type="radio" name="file" value="csv" checked>CSV
                                    </label>
                                    <label class="btn btn-default disabled">
                                        <input type="radio" name="file" value="json" >JSON
                                    </label>
                                    <label class="btn btn-default disabled" >
                                        <input type="radio" name="file" value="netCDF" disabled>netCDF
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="email" class="control-label input-group">Email address</label>
                                <input type="email" class="form-control" id="email" name="email" placeholder="Please enter your email">
                            </div>

                            <br />
                            <div class="form-group">
                                <!-- Submit/Cancel button !-->
                                <button type="button" class="btn btn-success btn-lg save">Process</button>
                                <button type="reset" class="btn btn-warning btn-lg reset">Cancel</button>
                            </div>

                        </form>
                    </div>


                    <script type="text/template" id="alert-success-tpl">
                        <div class="alert alert-success">
                            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
                            <i class="icon-check"></i> Request has been successful!
                        </div>
                    </script>


                    <script type="text/template" id="alert-danger-tpl">
                        <div class="alert alert-danger">
                            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
                            <i class="icon-ban-circle"></i> Error! Please try again.
                        </div>
                    </script>

                    <div class="alert-container"></div>

                </div>

            </div>

            <hr>


            <!--/.container new -->

            <script type="text/template" id="process-tpl">
                <div class="well">
                    <div class="row">
                        <div class="col-xs-6">
                            <a href="{{=name}}" class="btn btn-default btn-lg pull-left" data-placement="top"
                               data-original-title=".btn .btn-default .btn-lg">
                                {{==name }}
                            </a>
                        </div>
                        <div class="col-xs-6">
                            <a href="{{= startdate}}" class="nohover">
                                <icon class="icon-cog icon-2x text-success"></icon>
                            </a>
                        </div>

                    </div>
                </div>
            </script>

            <div class="row">
                <div class="col-md-12">
                    <section class="widget">
                        <header>
                            <h2>
                                Requests
                            </h2>
                        </header>


                        <div class="body text-align-center" id="requests-main-dp">

                            <div>
                                <div class="row">
                                    <div class="col-xs-6 pull-right">
                                        <a  id="refresh" name="refresh" class="btn btn-default btn-lg pull-right refresh" data-placement="top"
                                            data-original-title=".btn .btn-default .btn-lg"><span class="glyphicon glyphicon-refresh pull-left"/>
                                        </a>
                                    </div>
                                </div>
                            </div>

                            <hr/>


                        </div>
                    </section>
                </div>
            </div>

            <div class="overlay">
                <div id="loading-img"></div>
            </div>
            <!--/.container new -->



        </div><!--/row-->
    </div>



</div><!--/.container-->

<footer>
    <p class="pull-right">©2014-2016 University of Washington. Buckley Lab.</p>
</footer>
<script>
    var map = L.map('map').setView([39.70005491693909,-106.22817993164061 ], 10);
    mapLink =
            '<a href="http://openstreetmap.org">OpenStreetMap</a>';
    L.tileLayer(
            'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; ' + mapLink + ' Contributors',
                maxZoom: 18
            }).addTo(map);

    var LeafIcon = L.Icon.extend({
        options: {
            shadowUrl:
                    'http://leafletjs.com/docs/images/leaf-shadow.png',
            iconSize:     [38, 95],
            shadowSize:   [50, 64],
            iconAnchor:   [22, 94],
            shadowAnchor: [4, 62],
            popupAnchor:  [-3, -76]
        }
    });

    var greenIcon = new LeafIcon({
        iconUrl: 'http://leafletjs.com/docs/images/leaf-green.png'
    });

    var drawnItems = new L.FeatureGroup();
    map.addLayer(drawnItems);

    var drawControl = new L.Control.Draw({
        position: 'topleft',
        draw: {
            polygon: {
                shapeOptions: {
                    color: 'purple'
                },
                allowIntersection: false,
                drawError: {
                    color: 'orange',
                    timeout: 1000
                },
                showArea: true,
                metric: false,
                repeatMode: true
            },
            polyline: {
                shapeOptions: {
                    color: 'red'
                }
            },
            rect: {
                shapeOptions: {
                    color: 'green'
                }
            },
            circle: {
                shapeOptions: {
                    color: 'steelblue'
                }
            },
            marker: {
                icon: greenIcon
            }
        },
        edit: {
            featureGroup: drawnItems
        }
    });
    map.addControl(drawControl);

    map.on('draw:created', function (e) {
        var type = e.layerType,
                layer = e.layer;

        if (type === 'marker') {
            layer.bindPopup('A popup!');
            console.log("Marker created")
        }

        if (type === 'polygon') {

            console.log("polygon created" + layer)
            var width = layer.getBounds().getEast() - layer.getBounds().getWest();
            var height = layer.getBounds().getNorth() - layer.getBounds().getSouth();

            var lats = []; var lngs = [];

            for (var i = 0; i < layer._latlngs.length; i++)  {
                lats.push(layer._latlngs[i].lat);
                lngs.push(layer._latlngs[i].lng);

            }

            //Show the bounding box
            $("#lat").val( layer.getBounds().getCenter().lat );
            $("#lng").val( layer.getBounds().getCenter().lng );


        }

        drawnItems.addLayer(layer);

        //Clear the drawing layer after pressing submit/cancel
        $(".reset").on("click", function() {

            drawnItems.removeLayer(layer);
        });

        $(".save").on("click", function() {

            drawnItems.removeLayer(layer);
        });

    });

    $('.datepicker').datepicker("setDate", "01/01/1981");

</script>


<script src="https://cdn.rawgit.com/jashkenas/underscore/1.5.2/underscore.js"></script>
<script src="https://cdn.rawgit.com/jashkenas/backbone/1.1.0/backbone.js"></script>
<script src="https://cdn.rawgit.com/wyuenho/backbone-pageable/master/lib/backbone-pageable.js"></script>
<script src="https://cdn.rawgit.com/wyuenho/backgrid/master/lib/backgrid.js"></script>
<script src="https://cdn.rawgit.com/wyuenho/backgrid-filter/master/backgrid-filter.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/parsley.js/2.4.4/parsley.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.15.0/moment.min.js"></script>





</body>
</html>
